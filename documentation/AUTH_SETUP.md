# üîê –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó –¥–ª—è Preview/Development

–¶—è —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó –∑–∞—Ö–∏—â–∞—î –¥–æ—Å—Ç—É–ø –¥–æ —Å–∞–π—Ç—É –≤ **preview** —Ç–∞ **development** –µ–Ω–≤–∞–π—Ä–æ–Ω–º–µ–Ω—Ç–∞—Ö –Ω–∞ Vercel, –±–µ–∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –ø–ª–∞—Ç–Ω–∏—Ö —Ñ—ñ—á Vercel Password Protection.

## üìã –Ø–∫ —Ü–µ –ø—Ä–∞—Ü—é—î

1. **Edge Middleware** –ø–µ—Ä–µ—Ö–æ–ø–ª—é—î –≤—Å—ñ –∑–∞–ø–∏—Ç–∏ –≤ preview/development
2. –ü–µ—Ä–µ–≤—ñ—Ä—è—î –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –≤–∞–ª—ñ–¥–Ω–æ–≥–æ `auth_token` cookie
3. –Ø–∫—â–æ —Ç–æ–∫–µ–Ω—É –Ω–µ–º–∞—î –∞–±–æ –≤—ñ–Ω –Ω–µ–¥—ñ–π—Å–Ω–∏–π - —Ä–µ–¥—ñ—Ä–µ–∫—Ç–∏—Ç—å –Ω–∞ `/login`
4. –£ production –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è **–Ω–µ –ø—Ä–∞—Ü—é—î** (—Å–∞–π—Ç –¥–æ—Å—Ç—É–ø–Ω–∏–π –¥–ª—è –≤—Å—ñ—Ö)

## ‚öôÔ∏è –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Environment Variables –≤ Vercel

### –ö—Ä–æ–∫ 1: –ü–µ—Ä–µ–π–¥–∏ –≤ Vercel Dashboard

1. –í—ñ–¥–∫—Ä–∏–π —Å–≤—ñ–π –ø—Ä–æ—î–∫—Ç –≤ [Vercel Dashboard](https://vercel.com)
2. –ü–µ—Ä–µ–π–¥–∏ –≤ **Settings** ‚Üí **Environment Variables**

### –ö—Ä–æ–∫ 2: –î–æ–¥–∞–π –∑–º—ñ–Ω–Ω—ñ –æ—Ç–æ—á–µ–Ω–Ω—è

–î–æ–¥–∞–π –Ω–∞—Å—Ç—É–ø–Ω—ñ –∑–º—ñ–Ω–Ω—ñ:

| Name | Value | Environment |
|------|-------|-------------|
| `AUTH_USERNAME` | –¢–≤—ñ–π –ª–æ–≥—ñ–Ω | **Preview, Development** |
| `AUTH_PASSWORD` | –¢–≤—ñ–π –ø–∞—Ä–æ–ª—å | **Preview, Development** |
| `AUTH_TOKEN` | –§—ñ–∫—Å–æ–≤–∞–Ω–∏–π —Ç–æ–∫–µ–Ω (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ) | **Preview, Development** |
| `AUTH_SECRET` | –°–µ–∫—Ä–µ—Ç–Ω–∏–π –∫–ª—é—á (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ) | **Preview, Development** |

**‚ö†Ô∏è –í–ê–ñ–õ–ò–í–û:**
- **–ù–ï** –¥–æ–¥–∞–≤–∞–π —Ü—ñ –∑–º—ñ–Ω–Ω—ñ –≤ **Production** environment
- `AUTH_TOKEN` - –æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–∞ –∑–º—ñ–Ω–Ω–∞ –¥–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ñ—ñ–∫—Å–æ–≤–∞–Ω–æ–≥–æ —Ç–æ–∫–µ–Ω—É –∑–∞–º—ñ—Å—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó
  - –Ø–∫—â–æ `AUTH_TOKEN` –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–π - –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –≤—ñ–Ω
  - –Ø–∫—â–æ –Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–π - —Ç–æ–∫–µ–Ω –≥–µ–Ω–µ—Ä—É—î—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑ `username:password:secret`
- `AUTH_SECRET` - –æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–∞ –∑–º—ñ–Ω–Ω–∞ –¥–ª—è –¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó –±–µ–∑–ø–µ–∫–∏ –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó —Ç–æ–∫–µ–Ω—É (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è `default-secret-change-in-production`)
- –Ø–∫—â–æ –Ω–µ –≤–∫–∞–∑–∞—Ç–∏ `AUTH_SECRET`, —Å–∏—Å—Ç–µ–º–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—î –¥–µ—Ñ–æ–ª—Ç–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è

### –ö—Ä–æ–∫ 3: Redeploy

–ü—ñ—Å–ª—è –¥–æ–¥–∞–≤–∞–Ω–Ω—è –∑–º—ñ–Ω–Ω–∏—Ö:
1. –ü–µ—Ä–µ–π–¥–∏ –≤ **Deployments**
2. –ó–Ω–∞–π–¥–∏ –æ—Å—Ç–∞–Ω–Ω—ñ–π –¥–µ–ø–ª–æ–π
3. –ù–∞—Ç–∏—Å–Ω–∏ **‚ãÆ** (—Ç—Ä–∏ –∫—Ä–∞–ø–∫–∏) ‚Üí **Redeploy**
4. –ê–±–æ –∑—Ä–æ–±–∏ –Ω–æ–≤–∏–π push –≤ GitHub

## üéØ –Ø–∫ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏

### –£ Preview/Development —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞—Ö:

1. –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤—ñ–¥–∫—Ä–∏–≤–∞—î —Å–∞–π—Ç
2. –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Ä–µ–¥—ñ—Ä–µ–∫—Ç–∏—Ç—å—Å—è –Ω–∞ `/login`
3. –í–≤–æ–¥–∏—Ç—å –ª–æ–≥—ñ–Ω —Ç–∞ –ø–∞—Ä–æ–ª—å –∑ Environment Variables
4. –ú–æ–∂–µ –æ–±—Ä–∞—Ç–∏ "–ó–∞–ø–∞–º'—è—Ç–∞—Ç–∏ –º–µ–Ω–µ" (cookie –Ω–∞ 30 –¥–Ω—ñ–≤) –∞–±–æ –±–µ–∑ –Ω—å–æ–≥–æ (—Å–µ—Å—ñ–π–Ω–∏–π cookie)
5. –ü—ñ—Å–ª—è —É—Å–ø—ñ—à–Ω–æ—ó –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó –æ—Ç—Ä–∏–º—É—î –¥–æ—Å—Ç—É–ø –¥–æ —Å–∞–π—Ç—É

### –õ–æ–∫–∞–ª—å–Ω–∞ —Ä–æ–∑—Ä–æ–±–∫–∞ (–±–µ–∑ `vercel dev`)

1. –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Å—è, —â–æ —É —Ñ–∞–π–ª—ñ `.env` –∞–±–æ `.env.local` –≤–∫–∞–∑–∞–Ω—ñ `AUTH_USERNAME`, `AUTH_PASSWORD` (—Ç–∞ –æ–ø—Ü—ñ–π–Ω–æ `AUTH_TOKEN`, `AUTH_SECRET`).
2. –ù–∞–π–ø—Ä–æ—Å—Ç—ñ—à–µ: –∑–∞–ø—É—Å—Ç–∏ `npm run dev:safe`. –°–∫—Ä–∏–ø—Ç —Å–∞–º –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç—å, —á–∏ –ø–æ—Ä—Ç–∏ `8080` —Ç–∞ `3001` –≤—ñ–ª—å–Ω—ñ, –∑–≤—ñ–ª—å–Ω–∏—Ç—å Node-–ø—Ä–æ—Ü–µ—Å–∏, —è–∫—â–æ —Ç—Ä–µ–±–∞, —ñ –ø–æ—Ç—ñ–º —Å—Ç–∞—Ä—Ç—É—î Vite + Express.
3. –Ø–∫—â–æ –≤–ø–µ–≤–Ω–µ–Ω–∏–π, —â–æ –ø–æ—Ä—Ç–∏ —á–∏—Å—Ç—ñ, –º–æ–∂–Ω–∞ –∑–∞–ø—É—Å–∫–∞—Ç–∏ –Ω–∞–ø—Ä—è–º—É `npm run dev:all`.
4. –§—Ä–æ–Ω—Ç–µ–Ω–¥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø—Ä–æ–∫—Å–∏—Ç—å `/api/*` –Ω–∞ Express, —è–∫–∏–π —Ç–µ–ø–µ—Ä –º–∞—î –º–∞—Ä—à—Ä—É—Ç–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó (`/api/auth/login`, `/verify`, `/logout`, `/debug`).
5. –í—ñ–¥–∫—Ä–∏–π `http://localhost:8080/login`, —É–≤—ñ–π–¥–∏ –∑—ñ —Å–≤–æ—ó–º–∏ –¥–∞–Ω–∏–º–∏ —ñ —Ç–µ—Å—Ç—É–π —Å–∞–π—Ç —Ç–∞–∫ —Å–∞–º–æ, —è–∫ —É preview.
6. –Ø–∫—â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—à —Ç—ñ–ª—å–∫–∏ `.env.local`, –Ω–µ —Ö–≤–∏–ª—é–π—Å—è ‚Äî –±–µ–∫–µ–Ω–¥ —Ç–µ–ø–µ—Ä —è–≤–Ω–æ –ø—ñ–¥–≤–∞–Ω—Ç–∞–∂—É—î —ñ `.env`, —ñ `.env.local`, —Ç–æ–º—É –∑–º—ñ–Ω–Ω—ñ –≥–∞—Ä–∞–Ω—Ç–æ–≤–∞–Ω–æ –¥–æ—Å—Ç—É–ø–Ω—ñ.

### –£ Production:

- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è **–Ω–µ –ø—Ä–∞—Ü—é—î**
- –°–∞–π—Ç –¥–æ—Å—Ç—É–ø–Ω–∏–π –¥–ª—è –≤—Å—ñ—Ö –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó

## üîß –¢–µ—Ö–Ω—ñ—á–Ω—ñ –¥–µ—Ç–∞–ª—ñ

### –§–∞–π–ª–∏ —Å–∏—Å—Ç–µ–º–∏:

- `middleware.ts` - Vercel Edge Middleware –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó
- `api/auth/login.js` - API endpoint –¥–ª—è –ª–æ–≥—ñ–Ω—É
- `api/auth/logout.js` - API endpoint –¥–ª—è –≤–∏—Ö–æ–¥—É
- `api/auth/verify.js` - API endpoint –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Ç–æ–∫–µ–Ω—É
- `src/pages/Login.tsx` - –°—Ç–æ—Ä—ñ–Ω–∫–∞ –ª–æ–≥—ñ–Ω—É
- `src/hooks/use-auth.tsx` - React hook –¥–ª—è –∫–ª—ñ—î–Ω—Ç—Å—å–∫–æ—ó –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó

### –Ø–∫ –≤–∏–∑–Ω–∞—á–∞—î—Ç—å—Å—è –µ–Ω–≤–∞–π—Ä–æ–Ω–º–µ–Ω—Ç:

- **Production**: –¥–æ–º–µ–Ω –±–µ–∑ `git-` –∞–±–æ `preview` –≤ –Ω–∞–∑–≤—ñ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥: `ways2spain.vercel.app`)
- **Preview**: –¥–æ–º–µ–Ω –∑ `git-` –∞–±–æ `preview` (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥: `ways2spain-git-main-abc123.vercel.app`)
- **Development**: `localhost` –∞–±–æ `127.0.0.1`

### –ë–µ–∑–ø–µ–∫–∞ —Ç–æ–∫–µ–Ω—É:

- –¢–æ–∫–µ–Ω –º–æ–∂–µ –±—É—Ç–∏:
  - **–§—ñ–∫—Å–æ–≤–∞–Ω–∏–º** - —è–∫—â–æ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ `AUTH_TOKEN` –≤ ENV (–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —Ü–µ–π —Ç–æ–∫–µ–Ω)
  - **–ì–µ–Ω–µ—Ä–æ–≤–∞–Ω–∏–º** - —è–∫—â–æ `AUTH_TOKEN` –Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–π (–≥–µ–Ω–µ—Ä—É—î—Ç—å—Å—è —á–µ—Ä–µ–∑ SHA-256 —Ö–µ—à –≤—ñ–¥ `username:password:secret`)
- –ó–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è –≤ `httpOnly` cookie (–Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∏–π —á–µ—Ä–µ–∑ JavaScript)
- `secure` flag –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î—Ç—å—Å—è –≤ production
- `sameSite: lax` –¥–ª—è –∑–∞—Ö–∏—Å—Ç—É –≤—ñ–¥ CSRF
- –§—É–Ω–∫—Ü—ñ—è "–ó–∞–ø–∞–º'—è—Ç–∞—Ç–∏ –º–µ–Ω–µ" –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î cookie –Ω–∞ 30 –¥–Ω—ñ–≤, –±–µ–∑ –Ω–µ—ó - —Å–µ—Å—ñ–π–Ω–∏–π cookie

## üêõ –†–æ–∑–≤'—è–∑–∞–Ω–Ω—è –ø—Ä–æ–±–ª–µ–º

### –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è –Ω–µ –ø—Ä–∞—Ü—é—î –≤ preview

1. –ü–µ—Ä–µ–≤—ñ—Ä —á–∏ –¥–æ–¥–∞–Ω—ñ Environment Variables –≤ Vercel
2. –ü–µ—Ä–µ–≤—ñ—Ä —á–∏ –≤–æ–Ω–∏ –¥–æ–¥–∞–Ω—ñ –¥–ª—è **Preview** environment
3. –ó—Ä–æ–±–∏ redeploy –ø—ñ—Å–ª—è –¥–æ–¥–∞–≤–∞–Ω–Ω—è –∑–º—ñ–Ω–Ω–∏—Ö

### –ù–µ –º–æ–∂—É —É–≤—ñ–π—Ç–∏ (–Ω–µ–≤—ñ—Ä–Ω–∏–π –ª–æ–≥—ñ–Ω/–ø–∞—Ä–æ–ª—å)

1. –ü–µ—Ä–µ–≤—ñ—Ä —á–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤–≤–µ–¥–µ–Ω—ñ `AUTH_USERNAME` —Ç–∞ `AUTH_PASSWORD` –≤ Vercel
2. –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Å—è —â–æ –Ω–µ–º–∞—î –ø—Ä–æ–±—ñ–ª—ñ–≤ –Ω–∞ –ø–æ—á–∞—Ç–∫—É/–≤ –∫—ñ–Ω—Ü—ñ
3. –°–ø—Ä–æ–±—É–π –æ—á–∏—Å—Ç–∏—Ç–∏ cookies —Ç–∞ —Å–ø—Ä–æ–±—É–π –∑–Ω–æ–≤—É

### –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è –ø—Ä–∞—Ü—é—î –≤ production (–Ω–µ –ø–æ–≤–∏–Ω–Ω–∞)

1. –ü–µ—Ä–µ–≤—ñ—Ä —á–∏ Environment Variables **–ù–ï** –¥–æ–¥–∞–Ω—ñ –¥–ª—è Production
2. –ü–µ—Ä–µ–≤—ñ—Ä —á–∏ –¥–æ–º–µ–Ω –≤–∏–∑–Ω–∞—á–µ–Ω–∏–π –ø—Ä–∞–≤–∏–ª—å–Ω–æ —è–∫ production

### Cookie –Ω–µ –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è

1. –ü–µ—Ä–µ–≤—ñ—Ä —á–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è `credentials: 'include'` –≤ fetch –∑–∞–ø–∏—Ç–∞—Ö
2. –ü–µ—Ä–µ–≤—ñ—Ä —á–∏ –¥–æ–º–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π (–¥–ª—è localhost –º–æ–∂–µ –Ω–µ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ secure cookie)

## üìù –ü—Ä–∏–º—ñ—Ç–∫–∏

- –°–∏—Å—Ç–µ–º–∞ –ø—Ä–∞—Ü—é—î –Ω–∞ –¥–≤–æ—Ö —Ä—ñ–≤–Ω—è—Ö: **Edge Middleware** (—Å–µ—Ä–≤–µ—Ä) —Ç–∞ **–∫–ª—ñ—î–Ω—Ç—Å—å–∫–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞** (React)
- –¶–µ –∑–∞–±–µ–∑–ø–µ—á—É—î –ø–æ–¥–≤—ñ–π–Ω–∏–π –∑–∞—Ö–∏—Å—Ç –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ –æ–¥–∏–Ω –∑ –Ω–∏—Ö –Ω–µ —Å–ø—Ä–∞—Ü—é—î
- –î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ—ó —Ä–æ–∑—Ä–æ–±–∫–∏ –ø–æ—Ç—Ä—ñ–±–Ω–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ `.env` —Ñ–∞–π–ª (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)

